/* Use Case: Personalize subject line with subscribers name */
/* What it does: adds a personal touch to the email and grabs their attention */
/* Key Concepts: Pulling data from DE, concatenation */

%%[
var @FirstName
set @FirstName = AttributeValue("FirstName")
]%%

%%[
IF EMPTY(FirstName) THEN
SET @Subject = "There is still time to submit your diary"
ELSE 
SET @Subject = Concat(FirstName, ", there is still time to submit your diary")
ENDIF
]%%

%%=v(@Subject)=%%



/* Use Case: show pproduct recommendations  */
/* What it does: pulls 4 product recommendations from a DE. If there are no personalized products, it will show regular products */
/* Key Concepts: LookupOrderedRows, row iteration */

SET @products = LookupOrderedRows("Product_Recommendations_DE", 4, "Priority ASC", 
                                  "SubscriberKey", @subscriberKey)
SET @productCount = RowCount(@products)

/* If no personalized products, get default products */
IF @productCount == 0 THEN
  SET @products = LookupOrderedRows("Default_Products_DE", 4, "Priority ASC")
  SET @productCount = RowCount(@products)
ENDIF
